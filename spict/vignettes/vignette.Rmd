---
title: "SPiCT"
author: "Martin W. Pedersen"
date: '`16-08-2016`'
output: pdf_document
vignette: |
  %\VignetteIndexEntry{SPiCT} %\VignetteEngine{knitr::rmarkdown} %\VignetteEncoding{UTF-8}
---

```{r, echo = FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>")
```

This vignette explains basic and more advanced functions of the `spict` package. When loading the package you are notified which version of the package you have installed:

```{r}
library(spict)
```
The printed version follows the format ver@SHA, where ver is the manually defined version number and SHA refers to a unique commit on [github](http://github.com/mawp/spict). The content of this vignette pertains to the version printed above. 

## A simple example

The package contains the catch and index data analysed in Polacheck et al. (1993). This data can be loaded and plotted by typing

```{r}
data(pol) 
```

Data on three stocks are contained in this dataset. Here focus will be on the South Atlantic albacore data. This dataset contains the following

```{r}
pol$albacore
```

Note that data are structure in a list containing the entries `obsC` (catch observations), `timeC` (time of catch observations), `obsI` (index observations), and `timeI` (time of index observations). If times are not specified it is assumed that the first observation is observed at time 1 and then sequentially onward with a time step of one year. It is therefore recommended to always specify observation times.

The data can be plotted using the command

```{r, fig.width=5, fig.height=5.5, out.width='0.5\\textwidth', fig.align='center', fig.show='hold'}
plotspict.data(pol$albacore, qlegend = TRUE)
```

Note that the number of catch and index observations are given in the respective plot headers. Furthermore, note colour legend in the top-right corner (shown because of the argument `qlegend = TRUE`), which explains at what time of the year an observation was observed based on the colour of the individual points. For illustrative purposes let's try shifting the data a bit

```{r, fig.width=5, fig.height=5.5, out.width='0.5\\textwidth', fig.align='center', fig.show='hold', fig.cap="Blah"}
inp <- pol$albacore
inp$timeC <- inp$timeC + 0.3
inp$timeI <- inp$timeI + 0.8
plotspict.data(inp, qlegend = TRUE)
```

Now the colours show that catches are observed in the spring and index in the autumn.

Let's try to fit the model to the data

```{r, results='show', message=FALSE, warning=FALSE, fig.width=6.5, fig.height=5.5, fig.show='hold'}
system.time(rep <- fit.spict(pol$albacore))
```
The call to `fit.spict` is wrapped in the `system.time` command to check the time spent on the calculations. This is obviously not required, but done here to show that fitting the model only takes a few seconds. The result of the model fit is stored in `rep`, which can either be plotted using `plot` or summarised using `summary`.

## Styles

The `html_vignette` template includes a basic CSS theme. To override this theme you can specify your own CSS in the document metadata as follows:

    output: 
      rmarkdown::html_vignette:
        css: mystyles.css

## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
